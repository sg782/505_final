# Brain Tumor MRI Classification and Recommendation System

This project is a deep learning-based system for classifying brain tumors from MRI images, combined with a natural language model that generates recommendations for the user. It includes a PyTorch backend for training and inference, a Flask server for handling image uploads and model predictions, and a simple web frontend for interacting with the system.

## Features
- Classifies MRI brain scans into one of four categories:
  - Glioma
  - Meningioma
  - No Tumor
  - Pituitary Tumor
- Provides a text-based medical recommendation generated by a large language model (LLM) based on classification results.
- Displays classification probabilities as a bar graph using Chart.js.

## Project Structure

Test and Training Data omitted from submission due to large size, but the link can be found here:
https://www.kaggle.com/datasets/masoudnickparvar/brain-tumor-mri-dataset

It is important to organize the Data as follows:

    /data/ 

        /Training/ # Training images organized into subfolders by class 

        /Testing/ # Testing images organized into subfolders by class

Here is the file structure:

    /brain_tumor_predict.py # PyTorch prediction script 

    /brain_tumor_train.py # PyTorch training script 
    
    /server.py # Flask server for image upload and prediction
    
    /web/ 
        diagnose.html # Web page for doctors to upload images diagnose.js # JavaScript to handle uploads, plotting, and displaying results 
        
    /requirements.txt # Python dependencies README.md # Project documentation


## Setup Instructions

1. Get Data in the form required OR Clone the repository


2. Install Python Requirements
```bash
pip install -r requirements.txt
```



3. Prepare the Dataset

Place your MRI images into:

 - ./data/Training/ (for training if retraining)

 - ./data/Testing/ (for evaluation)

Each tumor type should be in its own subfolder (e.g., /glioma/, /meningioma/, etc.).

4. API Key Setup

This project requires an OpenAI API key for generating LLM-based recommendations.

 - Open brain_tumor_predict.py

 - Replace the placeholder string "<your-openai-api-key>" with your actual API key.

Important: For submission or public release, the API key is removed for privacy. Users must supply their own API key for full functionality.

Alternatively, you can set it via an environment variable:

```bash
export OPENAI_API_KEY='your-api-key-here'
```

## Running the Application
Start the Flask server:

```bash
python server.py
```
Open your web browser and navigate to:

```bash
http://localhost:5000
```
Upload an MRI image through the frontend.
The server will:

 - Predict tumor class probabilities

 - Generate a recommendation

 - Return the results to the frontend

 - Display a bar graph and a short recommendation.


### Model Details
- Model Backbone: ResNet-18 (transfer learning from ImageNet)

 - Fine-tuning: Only the fully connected layer is retrained

 - Loss Function: Cross-Entropy

 - Optimizer: Adam

 - Training: Three loops of 10 epoch training sessions.

 - Best Model Saving: Saves the best model based on training loss (best_model_weights.pth)

### Notes
- If the LLM service is unavailable (e.g., quota exhausted), the system falls back to a static recommendation.

- Classification and LLM responses are processed asynchronously for a smooth user experience.

- Frontend visualization is handled using Chart.js.

- Frontend is built with basic HTML, CSS, and vanilla JavaScript.

### Future Improvements
- Add file type validation on uploads (accept only valid image files)

- Improve LLM prompts for more specialized recommendations

- Allow re-training from the frontend with uploaded datasets

- Deploy the system with Docker for easier setup across machines








